<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Connexion Arduino Mega → Google Sheets</title>
</head>

<body>
<h1>Connexion Arduino Mega → Google Sheets</h1>

<button id="connect">Connecter l’Arduino</button>
<pre id="output"></pre>

<script>
let port;
const output = document.getElementById("output");

document.getElementById("connect").addEventListener("click", async () => {
  try {
    port = await navigator.serial.requestPort();
    await port.open({ baudRate: 9600 });

    const reader = port.readable.getReader();

    output.textContent += "Connexion réussie.\n\n";

    while (true) {
      const { value, done } = await reader.read();
      if (done) break;

      const text = new TextDecoder().decode(value);
      output.textContent += text;
    }
  } catch (err) {
    output.textContent += "Erreur : " + err + "\n";
  }
});
</script>

</body>
</html>
